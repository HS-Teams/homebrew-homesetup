#!/usr/bin/env bash

function _about_() {
  echo "Container runtimes on macOS (and Linux) with minimal setup"
}

function _install_() {

  local packages

  packages=('colima' 'docker' 'docker-compose' 'docker-credential-helper')

  # shellcheck disable=SC2154
  if ! command brew install "${packages[@]}" 1>/dev/null; then
    sed -i'' -e 's|"credsStore": ".*"|"credsStore": "osxkeychain"|g' ~/.docker/config.json
    __hhs_errcho "hspm.bash: unable to set official Adoptium key"
    return 1
  fi

  return 0
}

function _uninstall_() {
  packman="${HHS_MY_OS_PACKMAN}"

  command "${packman}" uninstall "${packages[@]}" &&
    command "${packman}" deps "$@" |
    xargs "${packman}" remove --ignore-dependencies

  return $?
}
